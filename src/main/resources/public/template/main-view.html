<!-- Lightbox -->
<div ng-if="display.showPanel">
	<lightbox-plus show="display.showPanel" on-close="closeBooking()">
		<container template="lightbox"></container>
	</lightbox-plus>
</div>

<section class="cell three">

	<div ng-if="hasWorkflowOrAnyResourceHasBehaviour('rbs.typemanage', 'publish')">
		<button ng-click="showManage()"><i18n>rbs.navigation.manage</i18n></button>
		<hr />
	</div>

	<h2><i18n>rbs.selector.mine</i18n></h2>

	<nav class="vertical row">
		<ul class="colored">
			<li>
				<a ng-click="switchSelectMine()" ng-class="{ selected: mine.selected === true }"><i18n>rbs.selector.mine.button</i18n></a>
			</li>
		</ul>
	</nav>
	<hr />

	<h2><i18n>rbs.selector.resources</i18n></h2>

	<nav class="vertical row">
		<ul class="colored">
			<li ng-repeat="resourceType in resourceTypes.all">
				<a ng-class="resourceType.color" ng-click="switchExpand(resourceType)">[[resourceType.name]]</a>
				<ul ng-if="resourceType.expanded === true" ng-class="resourceType.color">
					<li ng-repeat="resource in resourceType.resources.all">
						<a ng-click="switchSelect(resource)" ng-class="{ selected: resource.selected === true }">
							[[resource.name]] <span ng-if="resource.is_available !== true" class="long-badge right-magnet"><i18n>rbs.booking.resource.unavailable</i18n></span>
						</a>
					</li>
					<div ng-if="resourceType.resources.empty() === true"><i18n>rbs.resources.empty</i18n></div>
				</ul>
			</li>
			<div ng-if="resourceTypes.empty() === true"><i18n>rbs.types.empty</i18n></div>
		</ul>
	</nav>
	<hr />

	<div workflow="rbs.validator">
		<h2><i18n>rbs.selector.unprocessed</i18n></h2>

		<nav class="vertical row">
			<ul>
				<li>
					<a ng-click="switchSelectUnprocessed()" ng-class="{ selected: unprocessed.selected === true }"><i18n>rbs.selector.unprocessed.button</i18n></a>
				</li>
			</ul>
		</nav>
	</div>
</section>

<section class="cell nine">
	<div class="row">
		<button ng-click="newBooking()"><i18n>rbs.booking.create</i18n></button>

		<div class="display-buttons">
			<i class="show-list" ng-class="{ selected: display.list === true }" ng-click="displayList()"></i>
			<i class="show-icons" ng-class="{ selected: display.list === false }" ng-click="displayCalendar()"></i>
		</div>
	</div>
	<div class="row">
		<container template="bookings"></container>
	</div>
</section>

<section class="toggle-buttons" ng-class="{ hide: bookings.selection().length === 0 }">
	<div class="toggle block-container">
		<div class="row">
			<behaviour name="manage" resource="bookings.selection()" class="cell">
				<button ng-if="canEditBookingSelection()" ng-click="editBooking()"><i18n>edit</i18n></button>
				<button ng-if="! canEditBookingSelection()" disbaled class="disabled"><i18n>edit</i18n></button>
				<button ng-if="canDeleteBookingSelection()" ng-click="removeBookingSelection()"><i18n>remove</i18n></button>
				<button ng-if="! canDeleteBookingSelection()" disbaled class="disabled"><i18n>remove</i18n></button>
			</behaviour>
			<behaviour name="process" resource="bookings.selectionResources()" class="cell">
				<button ng-if="canProcessBookingSelection()" ng-click="validateBookingSelection()"><i18n>rbs.booking.validate</i18n></button>
				<button ng-if="! canProcessBookingSelection()" disbaled class="disabled"><i18n>rbs.booking.validate</i18n></button>
				<button ng-if="canProcessBookingSelection()" ng-click="refuseBookingSelection()"><i18n>rbs.booking.refuse</i18n></button>
				<button ng-if="! canProcessBookingSelection()" disbaled class="disabled"><i18n>rbs.booking.refuse</i18n></button>
			</behaviour>
		</div>
	</div>
</section>