<!-- Lightbox -->
<div ng-if="display.showPanel">
	<lightbox-plus show="display.showPanel" on-close="closeBooking()">
		<container template="lightbox"></container>
	</lightbox-plus>
</div>

<section class="cell three">
	<h1>Réservation de ressources</h1>
	<nav class="vertical row">

		<ul class="colored">
			<li ng-repeat="resourceType in resourceTypes.all">
				<a ng-class="resourceType.color" ng-click="switchExpand(resourceType)">[[resourceType.name]]</a>
				<ul ng-if="resourceType.expanded === true" ng-class="resourceType.color">
					<li ng-repeat="resource in resourceType.resources.all">
						<a ng-click="switchSelect(resource)" ng-class="{ selected: resource.selected === true }">
							[[resource.name]] <span ng-if="resource.is_available !== true" class="long-badge right-magnet"><i18n>rbs.booking.resource.unavailable</i18n></span>
						</a>
					</li>
					<li ng-if="resourceType.resources.empty() === true"><i18n>rbs.resources.empty</i18n></li>
				</ul>
			</li>
			<div ng-if="resourceTypes.empty() === true"><i18n>rbs.types.empty</i18n></div>
		</ul>

	<hr />
	</nav>
</section>

<section class="cell nine">
	<div class="row">
		<drop-down-button class="cell">
			<label class="opener"><i18n>rbs.booking.create</i18n></label>
			<opts>
				<li ng-click="newBooking()"><i18n>Réservation ponctuelle</i18n></li>
				<li ng-click="newBooking('periodic')"><i18n>Réservation périodique</i18n></li>
			</opts>
		</drop-down-button>

		<div class="display-buttons">
			<i class="show-list" ng-class="{ selected: display.list === true }" ng-click="displayList()"></i>
			<i class="show-calendar" ng-class="{ selected: display.list === false }" ng-click="displayCalendar()"></i>
			<i class="show-admin" ng-click="showManage()" ng-if="hasWorkflowOrAnyResourceHasBehaviour('rbs.typemanage', 'publish')"></i>
		</div>
	</div>
	<filters>
		<li ng-class="{ selected: mine.selected }">
			<label>
				<i class="mine type"></i>
				<input type="checkbox" ng-model="mine.selected" ng-change="switchSelectMine()" />
				<p><i18n>rbs.selector.mine</i18n></p>
			</label>
		</li>
		<li ng-class="{ selected: unprocessed.selected }" workflow="rbs.validator">
			<label>
				<i class="submitted type"></i>
				<input type="checkbox" ng-model="selectUnprocessed" ng-change="switchSelectUnprocessed()" />
				<p><i18n>rbs.selector.unprocessed</i18n></p>
			</label>
		</li>
	</filters>
	<div class="row">
		<container template="bookings"></container>
	</div>
</section>

<section class="toggle-buttons" ng-class="{ hide: bookings.selection().length === 0 }">
	<div class="toggle">
		<div class="row">
			<behaviour name="manage" resource="bookings.selection()" class="cell">
				<button ng-if="canEditBookingSelection()" ng-click="editBooking()"><i18n>edit</i18n></button>
				<button ng-if="! canEditBookingSelection()" disbaled class="disabled"><i18n>edit</i18n></button>
				<button ng-if="canDeleteBookingSelection()" ng-click="removeBookingSelection()"><i18n>remove</i18n></button>
				<button ng-if="! canDeleteBookingSelection()" disbaled class="disabled"><i18n>remove</i18n></button>
			</behaviour>
			<behaviour name="process" resource="bookings.selectionResources()" class="cell">
				<button ng-if="canProcessBookingSelection()" ng-click="validateBookingSelection()"><i18n>rbs.booking.validate</i18n></button>
				<button ng-if="! canProcessBookingSelection()" disbaled class="disabled"><i18n>rbs.booking.validate</i18n></button>
				<button ng-if="canProcessBookingSelection()" ng-click="refuseBookingSelection()"><i18n>rbs.booking.refuse</i18n></button>
				<button ng-if="! canProcessBookingSelection()" disbaled class="disabled"><i18n>rbs.booking.refuse</i18n></button>
			</behaviour>
		</div>
	</div>
</section>